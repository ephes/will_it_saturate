---

title: Caveats


keywords: fastai
sidebar: home_sidebar



nb_path: "02_run_benchmark.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_run_benchmark.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_size" class="doc_header"><code>convert_size</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/client.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_size</code>(<strong><code>size_bytes</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="c106c48f-dd7f-4ee9-94eb-6a9db1ca0679"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c106c48f-dd7f-4ee9-94eb-6a9db1ca0679');

            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "# export\n\n\ndef convert_size(size_bytes):\n    if size_bytes == 0:\n        return \"0B\"\n    size_name = (\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\")\n    i = int(math.floor(math.log(size_bytes, 1024)))\n    p = math.pow(1024, i)\n    s = round(size_bytes / p, 2)\n    return s, size_name[i]";
                var nbb_formatted_code = "# export\n\n\ndef convert_size(size_bytes):\n    if size_bytes == 0:\n        return \"0B\"\n    size_name = (\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\")\n    i = int(math.floor(math.log(size_bytes, 1024)))\n    p = math.pow(1024, i)\n    s = round(size_bytes / p, 2)\n    return s, size_name[i]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">byte</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">gigabit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="n">gigabit</span> <span class="o">/</span> <span class="n">byte</span>

<span class="n">benchmark</span> <span class="o">=</span> <span class="n">Benchmark</span><span class="p">(</span><span class="n">bandwidth</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># file_sizes = [10 ** 7, 10 ** 6]</span>
<span class="n">file_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">5</span><span class="p">]</span>
<span class="c1"># file_sizes = [10 ** 7]</span>
<span class="n">benchmark</span><span class="o">.</span><span class="n">create_rows</span><span class="p">(</span><span class="n">file_sizes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="9b398db9-c0a9-48ae-bda2-7171cba648d4"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#9b398db9-c0a9-48ae-bda2-7171cba648d4');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "byte = 8\ngigabit = 10 ** 9\nbandwidth = gigabit / byte\n\nbenchmark = Benchmark(bandwidth=bandwidth, duration=3)\n\n# file_sizes = [10 ** 7, 10 ** 6]\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n# file_sizes = [10 ** 7]\nbenchmark.create_rows(file_sizes)";
                var nbb_formatted_code = "byte = 8\ngigabit = 10 ** 9\nbandwidth = gigabit / byte\n\nbenchmark = Benchmark(bandwidth=bandwidth, duration=3)\n\n# file_sizes = [10 ** 7, 10 ** 6]\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n# file_sizes = [10 ** 7]\nbenchmark.create_rows(file_sizes)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseClient" class="doc_header"><code>class</code> <code>BaseClient</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/client.py#L34" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseClient</code>(<strong><code>benchmark</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="a4b33637-e9ce-41c8-b7b4-fce9a483ff7d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a4b33637-e9ce-41c8-b7b4-fce9a483ff7d');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# export\n\n\nclass BaseClient:\n    def __init__(self, benchmark):\n        self.benchmark = benchmark\n\n    def check_md5sums(self, benchmark_files, responses):\n        md5_lookup = {}\n        for response in responses:\n            url = str(response.url)\n            md5_lookup[url] = hashlib.md5(response.content).hexdigest()\n\n        for bf in benchmark_files:\n            assert bf.md5sum == md5_lookup.get(bf.url, \"wrong\")";
                var nbb_formatted_code = "# export\n\n\nclass BaseClient:\n    def __init__(self, benchmark):\n        self.benchmark = benchmark\n\n    def check_md5sums(self, benchmark_files, responses):\n        md5_lookup = {}\n        for response in responses:\n            url = str(response.url)\n            md5_lookup[url] = hashlib.md5(response.content).hexdigest()\n\n        for bf in benchmark_files:\n            assert bf.md5sum == md5_lookup.get(bf.url, \"wrong\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HttpxClient" class="doc_header"><code>class</code> <code>HttpxClient</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/client.py#L50" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HttpxClient</code>(<strong><code>benchmark</code></strong>) :: <a href="/will_it_saturate/run_benchmark.html#BaseClient"><code>BaseClient</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="483f21b7-14fd-4bcf-8ceb-a7e94460210e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#483f21b7-14fd-4bcf-8ceb-a7e94460210e');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "# export\n\n\nclass HttpxClient(BaseClient):\n    async def measure_benchmark_row(self, br):\n        urls = [bf.url for bf in br.files]\n        # httpx breaks on more than 100 parallel connections\n        max_connections = min(br.number_of_connections, 100)\n        limits = httpx.Limits(\n            max_keepalive_connections=5, max_connections=max_connections\n        )\n        start = time.perf_counter()\n        async with httpx.AsyncClient(limits=limits) as client:\n            responses = await asyncio.gather(*[client.get(url) for url in urls])\n        elapsed = time.perf_counter() - start\n        self.check_md5sums(br.files, responses)\n        br.elapsed = elapsed\n\n    async def run(self):\n        for br in self.benchmark.rows:\n            await self.measure_benchmark_row(br)";
                var nbb_formatted_code = "# export\n\n\nclass HttpxClient(BaseClient):\n    async def measure_benchmark_row(self, br):\n        urls = [bf.url for bf in br.files]\n        # httpx breaks on more than 100 parallel connections\n        max_connections = min(br.number_of_connections, 100)\n        limits = httpx.Limits(\n            max_keepalive_connections=5, max_connections=max_connections\n        )\n        start = time.perf_counter()\n        async with httpx.AsyncClient(limits=limits) as client:\n            responses = await asyncio.gather(*[client.get(url) for url in urls])\n        elapsed = time.perf_counter() - start\n        self.check_md5sums(br.files, responses)\n        br.elapsed = elapsed\n\n    async def run(self):\n        for br in self.benchmark.rows:\n            await self.measure_benchmark_row(br)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bclient</span> <span class="o">=</span> <span class="n">HttpxClient</span><span class="p">(</span><span class="n">benchmark</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="f87ee64e-de40-4628-b16a-b3b2cd74585c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#f87ee64e-de40-4628-b16a-b3b2cd74585c');

            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "bclient = HttpxClient(benchmark)";
                var nbb_formatted_code = "bclient = HttpxClient(benchmark)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">await</span> <span class="n">bclient</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="c11d92b6-0801-44ef-97d1-1a5216d22b57"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c11d92b6-0801-44ef-97d1-1a5216d22b57');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "await bclient.run()";
                var nbb_formatted_code = "await bclient.run()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark fastAPI + httpx: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark fastAPI + httpx: 
---------
File size: 9.54MB
59.63MB/s
---------
File size: 976.56KB
48.34MB/s
---------
File size: 97.66KB
11.57MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="f2051a01-3e73-474a-98e0-0e57d76015d0"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#f2051a01-3e73-474a-98e0-0e57d76015d0');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "print(\"Benchmark fastAPI + httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark fastAPI + httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark fastAPI + httpx: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark fastAPI + httpx: 
---------
File size: 9.54MB
46.68MB/s
---------
File size: 976.56KB
42.95MB/s
---------
File size: 97.66KB
26.27MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="c05b7f1c-df85-4de9-afd6-f287227732f2"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c05b7f1c-df85-4de9-afd6-f287227732f2');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "print(\"Benchmark fastAPI + httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark fastAPI + httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark Nginx with httpx: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark Nginx: 
---------
File size: 9.54MB
55.56MB/s
---------
File size: 976.56KB
49.69MB/s
---------
File size: 97.66KB
20.27MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="ae4c195e-18e4-48fc-8ed5-0b29507e2f11"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ae4c195e-18e4-48fc-8ed5-0b29507e2f11');

            setTimeout(function() {
                var nbb_cell_id = 52;
                var nbb_unformatted_code = "print(\"Benchmark Nginx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark Nginx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark Nginx with httpx: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark Nginx with httpx: 
---------
File size: 9.54MB
62.09MB/s
---------
File size: 976.56KB
74.07MB/s
---------
File size: 97.66KB
30.94MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="28851c2b-94c1-41d4-827f-8ffc43e6266e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#28851c2b-94c1-41d4-827f-8ffc43e6266e');

            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "print(\"Benchmark Nginx with httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark Nginx with httpx: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="aiohttp">aiohttp<a class="anchor-link" href="#aiohttp"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AioHttpResponse" class="doc_header"><code>class</code> <code>AioHttpResponse</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/client.py#L72" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AioHttpResponse</code>(<strong><code>url</code></strong>, <strong><code>content</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AioHttpClient" class="doc_header"><code>class</code> <code>AioHttpClient</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/client.py#L78" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AioHttpClient</code>(<strong><code>benchmark</code></strong>) :: <a href="/will_it_saturate/run_benchmark.html#BaseClient"><code>BaseClient</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="43d409dd-d281-4445-8180-2db138387888"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#43d409dd-d281-4445-8180-2db138387888');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "# export\n\n\nclass AioHttpResponse:\n    def __init__(self, url, content):\n        self.url = url\n        self.content = content\n\n\nclass AioHttpClient(BaseClient):\n    async def fetch_page(self, session, url):\n        async with session.get(url) as response:\n            content = await response.read()\n            return AioHttpResponse(url, content)\n\n    async def measure_benchmark_row(self, br):\n        urls = [bf.url for bf in br.files]\n        max_connections = min(br.number_of_connections, 200)\n        # max_connections = br.number_of_connections\n        conn = aiohttp.TCPConnector(limit=max_connections)\n        responses = []\n        start = time.perf_counter()\n        async with aiohttp.ClientSession(connector=conn) as session:\n            tasks = [asyncio.create_task(self.fetch_page(session, url)) for url in urls]\n            responses = await asyncio.gather(*tasks)\n        elapsed = time.perf_counter() - start\n        self.responses = responses\n        self.check_md5sums(br.files, responses)\n        br.elapsed = elapsed\n\n    async def run(self):\n        for br in self.benchmark.rows:\n            await self.measure_benchmark_row(br)";
                var nbb_formatted_code = "# export\n\n\nclass AioHttpResponse:\n    def __init__(self, url, content):\n        self.url = url\n        self.content = content\n\n\nclass AioHttpClient(BaseClient):\n    async def fetch_page(self, session, url):\n        async with session.get(url) as response:\n            content = await response.read()\n            return AioHttpResponse(url, content)\n\n    async def measure_benchmark_row(self, br):\n        urls = [bf.url for bf in br.files]\n        max_connections = min(br.number_of_connections, 200)\n        # max_connections = br.number_of_connections\n        conn = aiohttp.TCPConnector(limit=max_connections)\n        responses = []\n        start = time.perf_counter()\n        async with aiohttp.ClientSession(connector=conn) as session:\n            tasks = [asyncio.create_task(self.fetch_page(session, url)) for url in urls]\n            responses = await asyncio.gather(*tasks)\n        elapsed = time.perf_counter() - start\n        self.responses = responses\n        self.check_md5sums(br.files, responses)\n        br.elapsed = elapsed\n\n    async def run(self):\n        for br in self.benchmark.rows:\n            await self.measure_benchmark_row(br)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bclient</span> <span class="o">=</span> <span class="n">AioHttpClient</span><span class="p">(</span><span class="n">benchmark</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="0a32917b-70ee-478a-b2a3-df0455522a3d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#0a32917b-70ee-478a-b2a3-df0455522a3d');

            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "bclient = AioHttpClient(benchmark)";
                var nbb_formatted_code = "bclient = AioHttpClient(benchmark)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">await</span> <span class="n">bclient</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="41ac59b2-a764-44f5-b8ad-cfdac55ac119"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#41ac59b2-a764-44f5-b8ad-cfdac55ac119');

            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "await bclient.run()";
                var nbb_formatted_code = "await bclient.run()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark fastAPI with aiohttp: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>61.16 MB
54.44 MB
31.9 MB
</pre>
</div>
</div>

<div class="output_area">




<div id="500b7280-30df-49b9-991e-0b7ad3f6ca39"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#500b7280-30df-49b9-991e-0b7ad3f6ca39');

            setTimeout(function() {
                var nbb_cell_id = 22;
                var nbb_unformatted_code = "for br in benchmark.rows:\n    # print(br.elapsed)\n    # print(br.bytes_per_second)\n    print(\" \".join([str(_) for _ in convert_size(br.bytes_per_second)]))";
                var nbb_formatted_code = "for br in benchmark.rows:\n    # print(br.elapsed)\n    # print(br.bytes_per_second)\n    print(\" \".join([str(_) for _ in convert_size(br.bytes_per_second)]))";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark fastAPI with aiohttp: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark fastAPI with aiohttp: 
---------
File size: 9.54MB
49.37MB/s
---------
File size: 976.56KB
52.43MB/s
---------
File size: 97.66KB
35.38MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="58f2dea3-8e0a-4b9d-aeb3-5c63259bb04e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#58f2dea3-8e0a-4b9d-aeb3-5c63259bb04e');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "print(\"Benchmark fastAPI with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark fastAPI with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark Nginx with aiohttp: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark Nginx with aiohttp: 
---------
File size: 9.54MB
60.81MB/s
---------
File size: 976.56KB
56.63MB/s
---------
File size: 97.66KB
40.02MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="cdfa6c77-5c91-410c-81c4-6e2345965903"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#cdfa6c77-5c91-410c-81c4-6e2345965903');

            setTimeout(function() {
                var nbb_cell_id = 60;
                var nbb_unformatted_code = "print(\"Benchmark Nginx with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark Nginx with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark Nginx with aiohttp: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}{</span><span class="n">file_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_size</span><span class="p">,</span> <span class="n">file_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">file_size</span><span class="p">)</span>
    <span class="n">transferred_per_second</span><span class="p">,</span> <span class="n">transferred_unit</span> <span class="o">=</span> <span class="n">convert_size</span><span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">bytes_per_second</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transferred_per_second</span><span class="si">}{</span><span class="n">transferred_unit</span><span class="si">}</span><span class="s2">/s&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Benchmark Nginx with aiohttp: 
---------
File size: 9.54MB
80.27MB/s
---------
File size: 976.56KB
71.1MB/s
---------
File size: 97.66KB
56.49MB/s
</pre>
</div>
</div>

<div class="output_area">




<div id="c38661c7-ebe0-4ed9-8215-917cee32b2f6"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c38661c7-ebe0-4ed9-8215-917cee32b2f6');

            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "print(\"Benchmark Nginx with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_formatted_code = "print(\"Benchmark Nginx with aiohttp: \")\nfor br in benchmark.rows:\n    print(\"---------\")\n    file_size, file_unit = convert_size(br.file_size)\n    print(f\"File size: {file_size}{file_unit}\")\n    file_size, file_unit = convert_size(br.file_size)\n    transferred_per_second, transferred_unit = convert_size(br.bytes_per_second)\n    print(f\"{transferred_per_second}{transferred_unit}/s\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Export">Export<a class="anchor-link" href="#Export"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>

<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted 01_serve_files.ipynb.
Converted 02_run_benchmark.ipynb.
Converted 03_create_files_old.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

<div class="output_area">




<div id="62756e5a-4d3b-4796-adc1-2a8271402007"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#62756e5a-4d3b-4796-adc1-2a8271402007');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "from nbdev.export import notebook2script\n\nnotebook2script()";
                var nbb_formatted_code = "from nbdev.export import notebook2script\n\nnotebook2script()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

