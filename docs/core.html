---

title: module Core


keywords: fastai
sidebar: home_sidebar

summary: "Core benchmark logic"
description: "Core benchmark logic"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Benchmark-Server">Benchmark Server<a class="anchor-link" href="#Benchmark-Server"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BenchmarkServer" class="doc_header"><code>class</code> <code>BenchmarkServer</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L22" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BenchmarkServer</code>(<strong><code>name</code></strong>:<code>str</code>=<em><code>'base_server'</code></em>) :: <code>BaseModel</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="87bfccc4-c796-4cda-9a8c-6d0829c9ade0"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#87bfccc4-c796-4cda-9a8c-6d0829c9ade0');

            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "# export\n\n\nclass BenchmarkServer(BaseModel):\n    name: str = \"base_server\"\n\n    def create(self):\n        # do nothing\n        pass\n\n    def remove(self):\n        # do nothing\n        pass";
                var nbb_formatted_code = "# export\n\n\nclass BenchmarkServer(BaseModel):\n    name: str = \"base_server\"\n\n    def create(self):\n        # do nothing\n        pass\n\n    def remove(self):\n        # do nothing\n        pass";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Nginx Docker&quot;</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">BenchmarkServer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="60aa1540-3773-403d-9822-57c14c8f3900"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#60aa1540-3773-403d-9822-57c14c8f3900');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "name = \"Nginx Docker\"\nserver = BenchmarkServer(name=name)";
                var nbb_formatted_code = "name = \"Nginx Docker\"\nserver = BenchmarkServer(name=name)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">server</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="475dd67c-dacf-4a06-b494-3bb020194353"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#475dd67c-dacf-4a06-b494-3bb020194353');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "assert server.name == name";
                var nbb_formatted_code = "assert server.name == name";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Checksum-Mixin">Checksum Mixin<a class="anchor-link" href="#Checksum-Mixin"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CheckSumMixin" class="doc_header"><code>class</code> <code>CheckSumMixin</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L36" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CheckSumMixin</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="dcfb5929-b1bb-4174-b2f0-38223d413186"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#dcfb5929-b1bb-4174-b2f0-38223d413186');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "# export\n\n\nclass CheckSumMixin:\n    def calculate_checksum(self, content):\n        return hashlib.md5(content).hexdigest()";
                var nbb_formatted_code = "# export\n\n\nclass CheckSumMixin:\n    def calculate_checksum(self, content):\n        return hashlib.md5(content).hexdigest()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FooBar</span><span class="p">(</span><span class="n">CheckSumMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_method_returning_checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_checksum</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>


<span class="n">foobar</span> <span class="o">=</span> <span class="n">FooBar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="92df42f8-1bca-453c-901d-fdb4cb245c42"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#92df42f8-1bca-453c-901d-fdb4cb245c42');

            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "class FooBar(CheckSumMixin):\n    def some_method_returning_checksum(self, content):\n        return self.calculate_checksum(content)\n\n\nfoobar = FooBar()";
                var nbb_formatted_code = "class FooBar(CheckSumMixin):\n    def some_method_returning_checksum(self, content):\n        return self.calculate_checksum(content)\n\n\nfoobar = FooBar()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;foobar&quot;</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">foobar</span><span class="o">.</span><span class="n">some_method_returning_checksum</span><span class="p">(</span><span class="n">test_content</span><span class="p">)</span>
    <span class="o">==</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">test_content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="b721d7de-c92b-4743-b158-0493813a7ea6"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b721d7de-c92b-4743-b158-0493813a7ea6');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "test_content = b\"foobar\"\nassert (\n    foobar.some_method_returning_checksum(test_content)\n    == hashlib.md5(test_content).hexdigest()\n)";
                var nbb_formatted_code = "test_content = b\"foobar\"\nassert (\n    foobar.some_method_returning_checksum(test_content)\n    == hashlib.md5(test_content).hexdigest()\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Benchmark-Client">Benchmark Client<a class="anchor-link" href="#Benchmark-Client"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BenchmarkClient" class="doc_header"><code>class</code> <code>BenchmarkClient</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BenchmarkClient</code>(<strong><code>name</code></strong>:<code>str</code>=<em><code>'base_client'</code></em>) :: <a href="/will_it_saturate/core.html#CheckSumMixin"><code>CheckSumMixin</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="558216cf-1319-4e3f-8add-838608295572"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#558216cf-1319-4e3f-8add-838608295572');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "# export\n\n\nclass BenchmarkClient(CheckSumMixin, BaseModel):\n    name: str = \"base_client\"\n\n    def verify_checksums(self, benchmark_files, responses):\n        checksum_lookup = {}\n        for response in responses:\n            url = str(response.url)\n            checksum_lookup[url] = self.calculate_checksum(response.content)\n\n        for bf in benchmark_files:\n            assert bf.checksum == checksum_lookup.get(bf.url, None)";
                var nbb_formatted_code = "# export\n\n\nclass BenchmarkClient(CheckSumMixin, BaseModel):\n    name: str = \"base_client\"\n\n    def verify_checksums(self, benchmark_files, responses):\n        checksum_lookup = {}\n        for response in responses:\n            url = str(response.url)\n            checksum_lookup[url] = self.calculate_checksum(response.content)\n\n        for bf in benchmark_files:\n            assert bf.checksum == checksum_lookup.get(bf.url, None)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Httpx&quot;</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">BenchmarkClient</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="b7a8eb89-bed9-4662-98c1-71f294687a4c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b7a8eb89-bed9-4662-98c1-71f294687a4c');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "name = \"Httpx\"\nclient = BenchmarkClient(name=name)";
                var nbb_formatted_code = "name = \"Httpx\"\nclient = BenchmarkClient(name=name)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">client</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="06662abc-9e07-4b19-bb18-610f882d9219"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#06662abc-9e07-4b19-bb18-610f882d9219');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "assert client.name == name";
                var nbb_formatted_code = "assert client.name == name";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Benchmark-Files">Benchmark Files<a class="anchor-link" href="#Benchmark-Files"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FilesystemCreator" class="doc_header"><code>class</code> <code>FilesystemCreator</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L58" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FilesystemCreator</code>() :: <a href="/will_it_saturate/core.html#CheckSumMixin"><code>CheckSumMixin</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BenchmarkFile" class="doc_header"><code>class</code> <code>BenchmarkFile</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L72" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BenchmarkFile</code>(<strong><code>number</code></strong>:<code>int</code>, <strong><code>base_path</code></strong>:<code>str</code>, <strong><code>size</code></strong>:<code>int</code>, <strong><code>data_root</code></strong>:<code>str</code>=<em><code>'data'</code></em>, <strong><code>hostname</code></strong>:<code>str</code>=<em><code>'localhost'</code></em>, <strong><code>port</code></strong>:<code>int</code>=<em><code>8000</code></em>, <strong><code>checksum</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>creator</code></strong>:<code>Callable</code>=<em><code>&lt;will_it_saturate.core.FilesystemCreator object at 0x10ca04a90&gt;</code></em>) :: <code>BaseModel</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="d335115c-0492-4c4c-b63e-d24b643735f0"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d335115c-0492-4c4c-b63e-d24b643735f0');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "# export\n\n\nclass FilesystemCreator(CheckSumMixin):\n    def checksum_for_path(self, path):\n        with path.open(\"rb\") as f:\n            checksum = self.calculate_checksum(f.read())\n        return checksum\n\n    def __call__(self, path, size):\n        path.parent.mkdir(parents=True, exist_ok=True)\n        if not path.exists():\n            with path.open(\"wb\") as f:\n                f.write(os.urandom(size))\n        return self.checksum_for_path(path)\n\n\nclass BenchmarkFile(BaseModel):\n    number: int\n    base_path: str\n    size: int\n    data_root: str = \"data\"\n    hostname: str = \"localhost\"\n    port: int = 8000\n    checksum: Optional[str] = None\n    creator: Callable = FilesystemCreator()\n\n    @property\n    def filesystem_path(self):\n        return Path(self.data_root) / self.base_path / str(self.number)\n\n    def get_or_create(self):\n        self.checksum = self.creator(self.filesystem_path, self.size)\n\n    @property\n    def path(self):\n        return f\"{self.data_root}/{self.base_path}/{self.number}\"\n\n    @property\n    def host(self):\n        return f\"http://{self.hostname}:{self.port}\"\n\n    @property\n    def url(self):\n        return f\"{self.host}/{self.path}\"";
                var nbb_formatted_code = "# export\n\n\nclass FilesystemCreator(CheckSumMixin):\n    def checksum_for_path(self, path):\n        with path.open(\"rb\") as f:\n            checksum = self.calculate_checksum(f.read())\n        return checksum\n\n    def __call__(self, path, size):\n        path.parent.mkdir(parents=True, exist_ok=True)\n        if not path.exists():\n            with path.open(\"wb\") as f:\n                f.write(os.urandom(size))\n        return self.checksum_for_path(path)\n\n\nclass BenchmarkFile(BaseModel):\n    number: int\n    base_path: str\n    size: int\n    data_root: str = \"data\"\n    hostname: str = \"localhost\"\n    port: int = 8000\n    checksum: Optional[str] = None\n    creator: Callable = FilesystemCreator()\n\n    @property\n    def filesystem_path(self):\n        return Path(self.data_root) / self.base_path / str(self.number)\n\n    def get_or_create(self):\n        self.checksum = self.creator(self.filesystem_path, self.size)\n\n    @property\n    def path(self):\n        return f\"{self.data_root}/{self.base_path}/{self.number}\"\n\n    @property\n    def host(self):\n        return f\"http://{self.hostname}:{self.port}\"\n\n    @property\n    def url(self):\n        return f\"{self.host}/{self.path}\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base_path</span> <span class="o">=</span> <span class="s2">&quot;3000000_2_12500000&quot;</span>
<span class="n">benchmark_file</span> <span class="o">=</span> <span class="n">BenchmarkFile</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">base_path</span><span class="o">=</span><span class="n">base_path</span><span class="p">)</span>
<span class="n">benchmark_file</span><span class="o">.</span><span class="n">url</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;http://localhost:8000/data/3000000_2_12500000/0&#39;</pre>
</div>

</div>

<div class="output_area">




<div id="2b311755-d97f-4991-bfe1-37420bc3c3b4"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2b311755-d97f-4991-bfe1-37420bc3c3b4');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "base_path = \"3000000_2_12500000\"\nbenchmark_file = BenchmarkFile(number=0, size=10 ** 6 * 3, base_path=base_path)\nbenchmark_file.url";
                var nbb_formatted_code = "base_path = \"3000000_2_12500000\"\nbenchmark_file = BenchmarkFile(number=0, size=10 ** 6 * 3, base_path=base_path)\nbenchmark_file.url";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s2">&quot;localhost&quot;</span> <span class="ow">in</span> <span class="n">benchmark_file</span><span class="o">.</span><span class="n">url</span>
<span class="k">assert</span> <span class="n">base_path</span> <span class="ow">in</span> <span class="n">benchmark_file</span><span class="o">.</span><span class="n">url</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e9d74b3a-7d08-4e47-960c-ac5a7d501013"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e9d74b3a-7d08-4e47-960c-ac5a7d501013');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "assert \"localhost\" in benchmark_file.url\nassert base_path in benchmark_file.url";
                var nbb_formatted_code = "assert \"localhost\" in benchmark_file.url\nassert base_path in benchmark_file.url";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">3</span>


<span class="k">class</span> <span class="nc">TestCreator</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">size</span> <span class="o">==</span> <span class="n">file_size</span>
        <span class="k">return</span> <span class="s2">&quot;test_md5sum&quot;</span>


<span class="n">benchmark_file</span> <span class="o">=</span> <span class="n">BenchmarkFile</span><span class="p">(</span>
    <span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">file_size</span><span class="p">,</span> <span class="n">base_path</span><span class="o">=</span><span class="n">base_path</span><span class="p">,</span> <span class="n">creator</span><span class="o">=</span><span class="n">TestCreator</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">benchmark_file</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="06f67dad-567a-4e80-8dd9-7c9045cd255d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#06f67dad-567a-4e80-8dd9-7c9045cd255d');

            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "file_size = 10 ** 6 * 3\n\n\nclass TestCreator:\n    def __call__(self, path, size):\n        assert size == file_size\n        return \"test_md5sum\"\n\n\nbenchmark_file = BenchmarkFile(\n    number=0, size=file_size, base_path=base_path, creator=TestCreator()\n)\nbenchmark_file.get_or_create()";
                var nbb_formatted_code = "file_size = 10 ** 6 * 3\n\n\nclass TestCreator:\n    def __call__(self, path, size):\n        assert size == file_size\n        return \"test_md5sum\"\n\n\nbenchmark_file = BenchmarkFile(\n    number=0, size=file_size, base_path=base_path, creator=TestCreator()\n)\nbenchmark_file.get_or_create()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Benchmark-Rows">Benchmark Rows<a class="anchor-link" href="#Benchmark-Rows"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BenchmarkRow" class="doc_header"><code>class</code> <code>BenchmarkRow</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L104" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BenchmarkRow</code>(<strong><code>file_size</code></strong>:<code>int</code>, <strong><code>duration</code></strong>:<code>int</code>=<em><code>30</code></em>, <strong><code>bandwidth</code></strong>:<code>int</code>=<em><code>125000000</code></em>, <strong><code>files</code></strong>:<code>list</code>[<a href="/will_it_saturate/core.html#BenchmarkFile"><code>BenchmarkFile</code></a>]=<em><code>[]</code></em>, <strong><code>file_creator</code></strong>:<code>Callable</code>=<em><code>&lt;will_it_saturate.core.FilesystemCreator object at 0x11d696c70&gt;</code></em>, <strong><code>elapsed</code></strong>:<code>float</code>=<em><code>None</code></em>, <strong><code>data_root</code></strong>:<code>str</code>=<em><code>'data'</code></em>) :: <code>BaseModel</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="6d0f00d5-3899-4055-a3dd-68bfe9b3c33a"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#6d0f00d5-3899-4055-a3dd-68bfe9b3c33a');

            setTimeout(function() {
                var nbb_cell_id = 17;
                var nbb_unformatted_code = "# export\n\n\nclass BenchmarkRow(BaseModel):\n    file_size: int  # size of a single file\n    duration: int = 30  # in seconds\n    bandwidth: int = int(10 ** 9 / 8)  # in bytes per second\n    files: list[BenchmarkFile] = []\n    file_creator: Callable = FilesystemCreator()\n    elapsed: Optional[float] = None\n    data_root: str = \"data\"\n\n    def __str__(self):\n        return f\"size: {self.file_size} duration: {self.duration} bandwidth: {self.bandwidth}\"\n\n    @property\n    def base_path(self):\n        return f\"{self.file_size}_{self.duration}_{self.bandwidth}\"\n\n    @property\n    def complete_size(self):\n        return self.duration * self.bandwidth\n\n    @property\n    def number_of_files(self):\n        return math.ceil(self.complete_size / self.file_size)\n\n    @property\n    def number_of_connections(self):\n        return math.ceil(self.bandwidth / self.file_size)\n\n    def get_bytes_per_second(self, elapsed):\n        return self.complete_size / elapsed\n\n    @property\n    def bytes_per_second(self):\n        return self.complete_size / self.elapsed\n\n    def create_files(self):\n        print(\"create_files with: \", self.file_creator)\n        if len(self.files) > 0:\n            return\n        for num in range(self.number_of_files):\n            benchmark_file = BenchmarkFile(\n                number=num,\n                base_path=self.base_path,\n                size=self.file_size,\n                creator=self.file_creator,\n                data_root=self.data_root,\n            )\n            benchmark_file.get_or_create()\n            self.files.append(benchmark_file)";
                var nbb_formatted_code = "# export\n\n\nclass BenchmarkRow(BaseModel):\n    file_size: int  # size of a single file\n    duration: int = 30  # in seconds\n    bandwidth: int = int(10 ** 9 / 8)  # in bytes per second\n    files: list[BenchmarkFile] = []\n    file_creator: Callable = FilesystemCreator()\n    elapsed: Optional[float] = None\n    data_root: str = \"data\"\n\n    def __str__(self):\n        return f\"size: {self.file_size} duration: {self.duration} bandwidth: {self.bandwidth}\"\n\n    @property\n    def base_path(self):\n        return f\"{self.file_size}_{self.duration}_{self.bandwidth}\"\n\n    @property\n    def complete_size(self):\n        return self.duration * self.bandwidth\n\n    @property\n    def number_of_files(self):\n        return math.ceil(self.complete_size / self.file_size)\n\n    @property\n    def number_of_connections(self):\n        return math.ceil(self.bandwidth / self.file_size)\n\n    def get_bytes_per_second(self, elapsed):\n        return self.complete_size / elapsed\n\n    @property\n    def bytes_per_second(self):\n        return self.complete_size / self.elapsed\n\n    def create_files(self):\n        print(\"create_files with: \", self.file_creator)\n        if len(self.files) > 0:\n            return\n        for num in range(self.number_of_files):\n            benchmark_file = BenchmarkFile(\n                number=num,\n                base_path=self.base_path,\n                size=self.file_size,\n                creator=self.file_creator,\n                data_root=self.data_root,\n            )\n            benchmark_file.get_or_create()\n            self.files.append(benchmark_file)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">byte</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">hundred_mbit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">8</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="n">hundred_mbit</span> <span class="o">/</span> <span class="n">byte</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># seconds</span>
<span class="n">file_size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># 100MB</span>

<span class="n">benchmark_row</span> <span class="o">=</span> <span class="n">BenchmarkRow</span><span class="p">(</span>
    <span class="n">file_size</span><span class="o">=</span><span class="n">file_size</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
    <span class="n">bandwidth</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">,</span>
    <span class="n">file_creator</span><span class="o">=</span><span class="n">DummyCreator</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">benchmark_row</span><span class="o">.</span><span class="n">create_files</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">benchmark_row</span><span class="o">.</span><span class="n">files</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>create_files with:  &lt;__main__.DummyCreator object at 0x122b3edf0&gt;
9
</pre>
</div>
</div>

<div class="output_area">




<div id="30fb1bcf-407e-423b-b615-d8222b9f943b"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#30fb1bcf-407e-423b-b615-d8222b9f943b');

            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "byte = 8\nhundred_mbit = 10 ** 8\nbandwidth = hundred_mbit / byte\nduration = 2  # seconds\nfile_size = 10 ** 6 * 3  # 100MB\n\nbenchmark_row = BenchmarkRow(\n    file_size=file_size,\n    duration=duration,\n    bandwidth=bandwidth,\n    file_creator=DummyCreator(),\n)\nbenchmark_row.create_files()\nprint(len(benchmark_row.files))";
                var nbb_formatted_code = "byte = 8\nhundred_mbit = 10 ** 8\nbandwidth = hundred_mbit / byte\nduration = 2  # seconds\nfile_size = 10 ** 6 * 3  # 100MB\n\nbenchmark_row = BenchmarkRow(\n    file_size=file_size,\n    duration=duration,\n    bandwidth=bandwidth,\n    file_creator=DummyCreator(),\n)\nbenchmark_row.create_files()\nprint(len(benchmark_row.files))";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">byte</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">gigabit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span>

<span class="n">test_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;file_size&quot;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># 10MB</span>
    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;bandwidth&quot;</span><span class="p">:</span> <span class="n">gigabit</span> <span class="o">/</span> <span class="n">byte</span><span class="p">,</span>
    <span class="s2">&quot;file_creator&quot;</span><span class="p">:</span> <span class="n">DummyCreator</span><span class="p">(),</span>
<span class="p">}</span>

<span class="n">test_benchmark_row</span> <span class="o">=</span> <span class="n">BenchmarkRow</span><span class="p">(</span><span class="o">**</span><span class="n">test_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="737f99cc-90c5-4452-ba36-a30595e6da01"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#737f99cc-90c5-4452-ba36-a30595e6da01');

            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "byte = 8\ngigabit = 10 ** 9\n\ntest_params = {\n    \"file_size\": 10 ** 6 * 10,  # 10MB\n    \"duration\": 30,\n    \"bandwidth\": gigabit / byte,\n    \"file_creator\": DummyCreator(),\n}\n\ntest_benchmark_row = BenchmarkRow(**test_params)";
                var nbb_formatted_code = "byte = 8\ngigabit = 10 ** 9\n\ntest_params = {\n    \"file_size\": 10 ** 6 * 10,  # 10MB\n    \"duration\": 30,\n    \"bandwidth\": gigabit / byte,\n    \"file_creator\": DummyCreator(),\n}\n\ntest_benchmark_row = BenchmarkRow(**test_params)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">==</span> <span class="mi">125000000</span>
<span class="k">assert</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">number_of_files</span> <span class="o">==</span> <span class="mi">375</span>
<span class="k">assert</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">get_bytes_per_second</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span> <span class="o">==</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">bandwidth</span>
<span class="k">assert</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">number_of_connections</span> <span class="o">==</span> <span class="mi">13</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="0aed2523-52f0-4e51-bb3a-18f3e79ac74c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#0aed2523-52f0-4e51-bb3a-18f3e79ac74c');

            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "assert test_benchmark_row.bandwidth == 125000000\nassert test_benchmark_row.number_of_files == 375\nassert test_benchmark_row.get_bytes_per_second(30.0) == test_benchmark_row.bandwidth\nassert test_benchmark_row.number_of_connections == 13";
                var nbb_formatted_code = "assert test_benchmark_row.bandwidth == 125000000\nassert test_benchmark_row.number_of_files == 375\nassert test_benchmark_row.get_bytes_per_second(30.0) == test_benchmark_row.bandwidth\nassert test_benchmark_row.number_of_connections == 13";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">create_files</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">number_of_files</span>

<span class="c1"># assert we don&#39;t generate files twice</span>
<span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">create_files</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="n">test_benchmark_row</span><span class="o">.</span><span class="n">number_of_files</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>create_files with:  &lt;__main__.DummyCreator object at 0x10f96a2b0&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x10f96a2b0&gt;
</pre>
</div>
</div>

<div class="output_area">




<div id="82a598fb-e3fb-4e88-a0a6-53979f1a3c07"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#82a598fb-e3fb-4e88-a0a6-53979f1a3c07');

            setTimeout(function() {
                var nbb_cell_id = 22;
                var nbb_unformatted_code = "test_benchmark_row.create_files()\nassert len(test_benchmark_row.files) == test_benchmark_row.number_of_files\n\n# assert we don't generate files twice\ntest_benchmark_row.create_files()\nassert len(test_benchmark_row.files) == test_benchmark_row.number_of_files";
                var nbb_formatted_code = "test_benchmark_row.create_files()\nassert len(test_benchmark_row.files) == test_benchmark_row.number_of_files\n\n# assert we don't generate files twice\ntest_benchmark_row.create_files()\nassert len(test_benchmark_row.files) == test_benchmark_row.number_of_files";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Benchmark-Result">Benchmark Result<a class="anchor-link" href="#Benchmark-Result"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_size" class="doc_header"><code>convert_size</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L157" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_size</code>(<strong><code>size_bytes</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BenchmarkResult" class="doc_header"><code>class</code> <code>BenchmarkResult</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L167" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BenchmarkResult</code>(<strong><code>server</code></strong>:<code>str</code>, <strong><code>client</code></strong>:<code>str</code>, <strong><code>file_size</code></strong>:<code>int</code>, <strong><code>elapsed</code></strong>:<code>float</code>, <strong><code>complete_size</code></strong>:<code>int</code>, <strong><code>platform</code></strong>:<code>str</code>) :: <code>BaseModel</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="83ec3c35-3cd7-4add-a9a3-a65fde3bba8a"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#83ec3c35-3cd7-4add-a9a3-a65fde3bba8a');

            setTimeout(function() {
                var nbb_cell_id = 23;
                var nbb_unformatted_code = "# export\n\n\ndef convert_size(size_bytes):\n    if size_bytes == 0:\n        return \"0B\"\n    size_name = (\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\")\n    i = int(math.floor(math.log(size_bytes, 1024)))\n    p = math.pow(1024, i)\n    s = round(size_bytes / p, 2)\n    return s, size_name[i]\n\n\nclass BenchmarkResult(BaseModel):\n    server: str\n    client: str\n    file_size: int\n    elapsed: float\n    complete_size: int\n    platform: str\n\n    def make_readable(self, size_in_bytes):\n        size, unit = convert_size(size_in_bytes)\n        return f\"{size}{unit}\"\n\n    @property\n    def readable_file_size(self):\n        return self.make_readable(self.file_size)\n\n    @property\n    def bytes_per_second(self):\n        return self.complete_size / self.elapsed\n\n    @property\n    def readable_bytes_per_second(self):\n        return self.make_readable(self.bytes_per_second)\n\n    def dict(self):\n        _dict = super().dict()\n        return {\n            **super().dict(),\n            \"file_size_h\": self.readable_file_size,\n            \"bytes_per_second\": self.bytes_per_second,\n            \"bytes_per_second_h\": self.readable_bytes_per_second,\n        }";
                var nbb_formatted_code = "# export\n\n\ndef convert_size(size_bytes):\n    if size_bytes == 0:\n        return \"0B\"\n    size_name = (\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\")\n    i = int(math.floor(math.log(size_bytes, 1024)))\n    p = math.pow(1024, i)\n    s = round(size_bytes / p, 2)\n    return s, size_name[i]\n\n\nclass BenchmarkResult(BaseModel):\n    server: str\n    client: str\n    file_size: int\n    elapsed: float\n    complete_size: int\n    platform: str\n\n    def make_readable(self, size_in_bytes):\n        size, unit = convert_size(size_in_bytes)\n        return f\"{size}{unit}\"\n\n    @property\n    def readable_file_size(self):\n        return self.make_readable(self.file_size)\n\n    @property\n    def bytes_per_second(self):\n        return self.complete_size / self.elapsed\n\n    @property\n    def readable_bytes_per_second(self):\n        return self.make_readable(self.bytes_per_second)\n\n    def dict(self):\n        _dict = super().dict()\n        return {\n            **super().dict(),\n            \"file_size_h\": self.readable_file_size,\n            \"bytes_per_second\": self.bytes_per_second,\n            \"bytes_per_second_h\": self.readable_bytes_per_second,\n        }";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span>
<span class="n">complete_size</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">file_size</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">BenchmarkResult</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="s2">&quot;nginx&quot;</span><span class="p">,</span>
    <span class="n">client</span><span class="o">=</span><span class="s2">&quot;httpx&quot;</span><span class="p">,</span>
    <span class="n">file_size</span><span class="o">=</span><span class="n">file_size</span><span class="p">,</span>
    <span class="n">elapsed</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
    <span class="n">complete_size</span><span class="o">=</span><span class="n">complete_size</span><span class="p">,</span>
    <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;server&#39;: &#39;nginx&#39;, &#39;client&#39;: &#39;httpx&#39;, &#39;file_size&#39;: 1000000, &#39;elapsed&#39;: 3.0, &#39;complete_size&#39;: 100000000, &#39;platform&#39;: &#39;x86_64&#39;, &#39;file_size_h&#39;: &#39;976.56KB&#39;, &#39;bytes_per_second&#39;: 33333333.333333332, &#39;bytes_per_second_h&#39;: &#39;31.79MB&#39;}
</pre>
</div>
</div>

<div class="output_area">




<div id="2d345edd-b77f-42bf-b255-3b2c29ac54cf"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2d345edd-b77f-42bf-b255-3b2c29ac54cf');

            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "file_size = 10 ** 6\ncomplete_size = 100 * file_size\nresult = BenchmarkResult(\n    server=\"nginx\",\n    client=\"httpx\",\n    file_size=file_size,\n    elapsed=3.0,\n    complete_size=complete_size,\n    platform=\"x86_64\",\n)\nprint(result.dict())";
                var nbb_formatted_code = "file_size = 10 ** 6\ncomplete_size = 100 * file_size\nresult = BenchmarkResult(\n    server=\"nginx\",\n    client=\"httpx\",\n    file_size=file_size,\n    elapsed=3.0,\n    complete_size=complete_size,\n    platform=\"x86_64\",\n)\nprint(result.dict())";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">readable_bytes_per_second</span> <span class="o">==</span> <span class="s2">&quot;31.79MB&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="13467231-4f20-4bb8-8bd0-05fc5f176d34"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#13467231-4f20-4bb8-8bd0-05fc5f176d34');

            setTimeout(function() {
                var nbb_cell_id = 25;
                var nbb_unformatted_code = "assert result.readable_bytes_per_second == \"31.79MB\"";
                var nbb_formatted_code = "assert result.readable_bytes_per_second == \"31.79MB\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Core-Benchmark-Model">Core Benchmark Model<a class="anchor-link" href="#Core-Benchmark-Model"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Benchmark" class="doc_header"><code>class</code> <code>Benchmark</code><a href="https://github.com/ephes/will_it_saturate/tree/main/will_it_saturate/core.py#L205" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Benchmark</code>(<strong><code>duration</code></strong>:<code>int</code>=<em><code>30</code></em>, <strong><code>bandwidth</code></strong>:<code>int</code>=<em><code>125000000</code></em>, <strong><code>file_sizes</code></strong>:<code>list</code>[<code>int</code>]=<em><code>[10000000, 1000000, 100000]</code></em>, <strong><code>rows</code></strong>:<code>list</code>[<a href="/will_it_saturate/core.html#BenchmarkRow"><code>BenchmarkRow</code></a>]=<em><code>[]</code></em>, <strong><code>file_creator</code></strong>:<code>Callable</code>=<em><code>&lt;will_it_saturate.core.FilesystemCreator object at 0x11f91d2b0&gt;</code></em>, <strong><code>platform</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>cpuinfo</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong><code>servers</code></strong>:<code>list</code>[<a href="/will_it_saturate/core.html#BenchmarkServer"><code>BenchmarkServer</code></a>]=<em><code>[]</code></em>, <strong><code>clients</code></strong>:<code>list</code>[<a href="/will_it_saturate/core.html#BenchmarkClient"><code>BenchmarkClient</code></a>]=<em><code>[]</code></em>, <strong><code>results</code></strong>:<code>list</code>[<a href="/will_it_saturate/core.html#BenchmarkResult"><code>BenchmarkResult</code></a>]=<em><code>[]</code></em>) :: <code>BaseModel</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">byte</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">hundred_mbit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">8</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="n">hundred_mbit</span> <span class="o">/</span> <span class="n">byte</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># seconds</span>
<span class="n">file_size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># 100MB</span>
<span class="n">file_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">benchmark</span> <span class="o">=</span> <span class="n">Benchmark</span><span class="p">(</span>
    <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
    <span class="n">bandwidth</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">,</span>
    <span class="n">file_creator</span><span class="o">=</span><span class="n">DummyCreator</span><span class="p">(),</span>
    <span class="n">file_sizes</span><span class="o">=</span><span class="n">file_sizes</span><span class="p">,</span>
    <span class="n">servers</span><span class="o">=</span><span class="p">[</span><span class="n">DummyServer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Nginx&quot;</span><span class="p">)],</span>
    <span class="n">clients</span><span class="o">=</span><span class="p">[</span><span class="n">DummyClient</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Httpx&quot;</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">benchmark</span><span class="o">.</span><span class="n">create_rows</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">))</span>

<span class="n">benchmark</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">benchmark</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>create_files with:  &lt;__main__.DummyCreator object at 0x122cb3a90&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122cb3a90&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122cb3a90&gt;
3
[BenchmarkResult(server=&#39;Nginx&#39;, client=&#39;Httpx&#39;, file_size=10000000, elapsed=2.0, complete_size=25000000, platform=&#39;x86_64&#39;), BenchmarkResult(server=&#39;Nginx&#39;, client=&#39;Httpx&#39;, file_size=1000000, elapsed=2.0, complete_size=25000000, platform=&#39;x86_64&#39;), BenchmarkResult(server=&#39;Nginx&#39;, client=&#39;Httpx&#39;, file_size=100000, elapsed=2.0, complete_size=25000000, platform=&#39;x86_64&#39;)]
</pre>
</div>
</div>

<div class="output_area">




<div id="09b62894-a1b7-4c34-99ec-cc9fac37289d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#09b62894-a1b7-4c34-99ec-cc9fac37289d');

            setTimeout(function() {
                var nbb_cell_id = 28;
                var nbb_unformatted_code = "# dont_test\n\nbyte = 8\nhundred_mbit = 10 ** 8\nbandwidth = hundred_mbit / byte\nduration = 2  # seconds\nfile_size = 10 ** 6 * 3  # 100MB\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n\nbenchmark = Benchmark(\n    duration=duration,\n    bandwidth=bandwidth,\n    file_creator=DummyCreator(),\n    file_sizes=file_sizes,\n    servers=[DummyServer(name=\"Nginx\")],\n    clients=[DummyClient(name=\"Httpx\")],\n)\nbenchmark.create_rows()\nprint(len(benchmark.rows))\n\nbenchmark.run()\nprint(benchmark.results)";
                var nbb_formatted_code = "# dont_test\n\nbyte = 8\nhundred_mbit = 10 ** 8\nbandwidth = hundred_mbit / byte\nduration = 2  # seconds\nfile_size = 10 ** 6 * 3  # 100MB\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n\nbenchmark = Benchmark(\n    duration=duration,\n    bandwidth=bandwidth,\n    file_creator=DummyCreator(),\n    file_sizes=file_sizes,\n    servers=[DummyServer(name=\"Nginx\")],\n    clients=[DummyClient(name=\"Httpx\")],\n)\nbenchmark.create_rows()\nprint(len(benchmark.rows))\n\nbenchmark.run()\nprint(benchmark.results)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">benchmark</span><span class="o">.</span><span class="n">results_frame</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>server</th>
      <th>client</th>
      <th>file_size</th>
      <th>elapsed</th>
      <th>complete_size</th>
      <th>platform</th>
      <th>file_size_h</th>
      <th>bytes_per_second</th>
      <th>bytes_per_second_h</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nginx</td>
      <td>Httpx</td>
      <td>10000000</td>
      <td>2.0</td>
      <td>25000000</td>
      <td>x86_64</td>
      <td>9.54MB</td>
      <td>12500000.0</td>
      <td>11.92MB</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nginx</td>
      <td>Httpx</td>
      <td>1000000</td>
      <td>2.0</td>
      <td>25000000</td>
      <td>x86_64</td>
      <td>976.56KB</td>
      <td>12500000.0</td>
      <td>11.92MB</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nginx</td>
      <td>Httpx</td>
      <td>100000</td>
      <td>2.0</td>
      <td>25000000</td>
      <td>x86_64</td>
      <td>97.66KB</td>
      <td>12500000.0</td>
      <td>11.92MB</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="e342a686-8d10-4372-aa48-6d79cc642d9d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e342a686-8d10-4372-aa48-6d79cc642d9d');

            setTimeout(function() {
                var nbb_cell_id = 36;
                var nbb_unformatted_code = "# dont_test\n\nbenchmark.results_frame";
                var nbb_formatted_code = "# dont_test\n\nbenchmark.results_frame";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">byte</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">gigabit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span>
<span class="n">file_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">test_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;bandwidth&quot;</span><span class="p">:</span> <span class="n">gigabit</span> <span class="o">/</span> <span class="n">byte</span><span class="p">,</span>
    <span class="s2">&quot;file_creator&quot;</span><span class="p">:</span> <span class="n">DummyCreator</span><span class="p">(),</span>
    <span class="s2">&quot;file_sizes&quot;</span><span class="p">:</span> <span class="n">file_sizes</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">test_benchmark</span> <span class="o">=</span> <span class="n">Benchmark</span><span class="p">(</span><span class="o">**</span><span class="n">test_params</span><span class="p">)</span>

<span class="n">test_benchmark</span><span class="o">.</span><span class="n">create_rows</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_sizes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
CPU times: user 1.08 s, sys: 31.1 ms, total: 1.11 s
Wall time: 1.11 s
</pre>
</div>
</div>

<div class="output_area">




<div id="673c494f-3db4-4085-a05d-09ad9191d958"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#673c494f-3db4-4085-a05d-09ad9191d958');

            setTimeout(function() {
                var nbb_cell_id = 30;
                var nbb_unformatted_code = "%%time\nbyte = 8\ngigabit = 10 ** 9\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n\ntest_params = {\n    \"duration\": 30,\n    \"bandwidth\": gigabit / byte,\n    \"file_creator\": DummyCreator(),\n    \"file_sizes\": file_sizes,\n}\n\ntest_benchmark = Benchmark(**test_params)\n\ntest_benchmark.create_rows()\nassert len(test_benchmark.rows) == len(file_sizes)";
                var nbb_formatted_code = "%%time\nbyte = 8\ngigabit = 10 ** 9\nfile_sizes = [10 ** 7, 10 ** 6, 10 ** 5]\n\ntest_params = {\n    \"duration\": 30,\n    \"bandwidth\": gigabit / byte,\n    \"file_creator\": DummyCreator(),\n    \"file_sizes\": file_sizes,\n}\n\ntest_benchmark = Benchmark(**test_params)\n\ntest_benchmark.create_rows()\nassert len(test_benchmark.rows) == len(file_sizes)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TestClient</span><span class="p">(</span><span class="n">BenchmarkClient</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benchmark_row</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;measure_benchmark_row: &quot;</span><span class="p">,</span> <span class="n">benchmark_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">2.0</span>


<span class="k">class</span> <span class="nc">TestServer</span><span class="p">(</span><span class="n">BenchmarkServer</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="n">test_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">**</span><span class="n">test_params</span><span class="p">,</span>
    <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">DummyClient</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)],</span>
    <span class="s2">&quot;servers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">DummyServer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)],</span>
<span class="p">}</span>
<span class="n">test_benchmark</span> <span class="o">=</span> <span class="n">Benchmark</span><span class="p">(</span><span class="o">**</span><span class="n">test_params</span><span class="p">)</span>
<span class="n">test_benchmark</span><span class="o">.</span><span class="n">create_rows</span><span class="p">()</span>
<span class="n">test_benchmark</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
create_files with:  &lt;__main__.DummyCreator object at 0x122dc8340&gt;
</pre>
</div>
</div>

<div class="output_area">




<div id="7a23d2ab-98b4-453a-9b34-7c487f5d8e07"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7a23d2ab-98b4-453a-9b34-7c487f5d8e07');

            setTimeout(function() {
                var nbb_cell_id = 31;
                var nbb_unformatted_code = "class TestClient(BenchmarkClient):\n    def measure(self, benchmark_row):\n        print(\"measure_benchmark_row: \", benchmark_row)\n        return 2.0\n\n\nclass TestServer(BenchmarkServer):\n    pass\n\n\ntest_params = {\n    **test_params,\n    \"clients\": [DummyClient(name=\"foo\")],\n    \"servers\": [DummyServer(name=\"bar\")],\n}\ntest_benchmark = Benchmark(**test_params)\ntest_benchmark.create_rows()\ntest_benchmark.run()";
                var nbb_formatted_code = "class TestClient(BenchmarkClient):\n    def measure(self, benchmark_row):\n        print(\"measure_benchmark_row: \", benchmark_row)\n        return 2.0\n\n\nclass TestServer(BenchmarkServer):\n    pass\n\n\ntest_params = {\n    **test_params,\n    \"clients\": [DummyClient(name=\"foo\")],\n    \"servers\": [DummyServer(name=\"bar\")],\n}\ntest_benchmark = Benchmark(**test_params)\ntest_benchmark.create_rows()\ntest_benchmark.run()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_benchmark</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_benchmark</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="c89007c8-9d45-41f6-961c-6e68ab74d984"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c89007c8-9d45-41f6-961c-6e68ab74d984');

            setTimeout(function() {
                var nbb_cell_id = 32;
                var nbb_unformatted_code = "assert len(test_benchmark.results) == len(test_benchmark.rows)";
                var nbb_formatted_code = "assert len(test_benchmark.results) == len(test_benchmark.rows)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_benchmark</span><span class="o">.</span><span class="n">servers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">started</span>
<span class="k">assert</span> <span class="n">test_benchmark</span><span class="o">.</span><span class="n">servers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stopped</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="fe2581e6-9c97-47fa-b333-79877d7264da"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#fe2581e6-9c97-47fa-b333-79877d7264da');

            setTimeout(function() {
                var nbb_cell_id = 33;
                var nbb_unformatted_code = "assert test_benchmark.servers[0].started\nassert test_benchmark.servers[0].stopped";
                var nbb_formatted_code = "assert test_benchmark.servers[0].started\nassert test_benchmark.servers[0].stopped";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_benchmark</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="n">platform</span><span class="o">.</span><span class="n">machine</span><span class="p">()</span>
<span class="k">assert</span> <span class="s2">&quot;python_version&quot;</span> <span class="ow">in</span> <span class="n">test_benchmark</span><span class="o">.</span><span class="n">cpuinfo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e6fb3e3b-408e-47a0-b553-8f258663b2a9"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e6fb3e3b-408e-47a0-b553-8f258663b2a9');

            setTimeout(function() {
                var nbb_cell_id = 34;
                var nbb_unformatted_code = "assert test_benchmark.platform == platform.machine()\nassert \"python_version\" in test_benchmark.cpuinfo";
                var nbb_formatted_code = "assert test_benchmark.platform == platform.machine()\nassert \"python_version\" in test_benchmark.cpuinfo";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Export">Export<a class="anchor-link" href="#Export"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>

<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted 01_serve_files_uvicorn.ipynb.
Converted 02_benchmark_clients.ipynb.
Converted 03_run_benchmark.ipynb.
Converted 04_use_nginx_to_serve_files.ipynb.
Converted 05_run_wrk_benchmark.ipynb.
Converted 06_fastapi_uvicorn_server.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

<div class="output_area">




<div id="e22bc006-8487-4e0d-9583-a22dd18ece51"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e22bc006-8487-4e0d-9583-a22dd18ece51');

            setTimeout(function() {
                var nbb_cell_id = 35;
                var nbb_unformatted_code = "# dont_test\n\nfrom nbdev.export import notebook2script\n\nnotebook2script()";
                var nbb_formatted_code = "# dont_test\n\nfrom nbdev.export import notebook2script\n\nnotebook2script()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

